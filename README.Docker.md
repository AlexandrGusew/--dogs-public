# ๐ณ Docker Deployment Guide

ะะพะปะฝะพะต ััะบะพะฒะพะดััะฒะพ ะฟะพ ะดะตะฟะปะพั Cat-Dogs ะฟัะธะปะพะถะตะฝะธั ั ะฟะพะผะพััั Docker.

---

## ๐ ะกะพะดะตัะถะฐะฝะธะต

- [ะะพะบะฐะปัะฝัะน ะทะฐะฟััะบ](#ะปะพะบะฐะปัะฝัะน-ะทะฐะฟััะบ-ั-docker-compose)
- [ะะตะฟะปะพะน ะฝะฐ Railway](#ะดะตะฟะปะพะน-ะฝะฐ-railway)
- [ะะตะฟะปะพะน ะฝะฐ Fly.io](#ะดะตะฟะปะพะน-ะฝะฐ-flyio)
- [ะะพะปะตะทะฝัะต ะบะพะผะฐะฝะดั](#ะฟะพะปะตะทะฝัะต-docker-ะบะพะผะฐะฝะดั)

---

## ๐ ะะพะบะฐะปัะฝัะน ะทะฐะฟััะบ ั Docker Compose

### ะัะตะดะฒะฐัะธัะตะปัะฝัะต ััะตะฑะพะฒะฐะฝะธั:

- [Docker Desktop](https://www.docker.com/products/docker-desktop/) ัััะฐะฝะพะฒะปะตะฝ ะธ ะทะฐะฟััะตะฝ
- Git ัะตะฟะพะทะธัะพัะธะน ัะบะปะพะฝะธัะพะฒะฐะฝ

### ะจะฐะณ 1: ะะฐัััะพะนะบะฐ ะฟะตัะตะผะตะฝะฝัั ะพะบััะถะตะฝะธั

```bash
# ะกะบะพะฟะธััะนัะต example ัะฐะนะป
cp .env.docker.example .env.docker

# ะััะตะดะฐะบัะธััะนัะต .env.docker (ะพะฟัะธะพะฝะฐะปัะฝะพ)
# ะะพ ัะผะพะปัะฐะฝะธั ัะถะต ะฝะฐัััะพะตะฝะพ ะดะปั ะปะพะบะฐะปัะฝะพะณะพ ะทะฐะฟััะบะฐ
```

### ะจะฐะณ 2: ะะฐะฟััะบ ะฒัะตะณะพ ััะตะบะฐ

```bash
# ะกะพะฑัะฐัั ะธ ะทะฐะฟัััะธัั ะฒัะต ัะตัะฒะธัั
docker-compose --env-file .env.docker up --build

# ะะปะธ ะฒ ัะพะฝะพะฒะพะผ ัะตะถะธะผะต:
docker-compose --env-file .env.docker up --build -d
```

### ะจะฐะณ 3: ะัะพะฒะตัะบะฐ ัะฐะฑะพัั

ะัะบัะพะนัะต ะฒ ะฑัะฐัะทะตัะต:
- **ะะปะธะตะฝั:** http://localhost
- **API:** http://localhost:3001
- **ะะ:** localhost:5432 (ะผะพะถะฝะพ ะฟะพะดะบะปััะธัััั ัะตัะตะท TablePlus/pgAdmin)

### ะััะฐะฝะพะฒะบะฐ:

```bash
# ะััะฐะฝะพะฒะธัั ะฒัะต ะบะพะฝัะตะนะฝะตัั
docker-compose down

# ะััะฐะฝะพะฒะธัั ะธ ัะดะฐะปะธัั volumes (ะฑะฐะทะฐ ะดะฐะฝะฝัั):
docker-compose down -v
```

---

## ๐ ะะตะฟะปะพะน ะฝะฐ Railway

[Railway](https://railway.app) - ะฟัะพััะฐั ะฟะปะฐััะพัะผะฐ ะดะปั ะดะตะฟะปะพั Docker ะฟัะธะปะพะถะตะฝะธะน.

### ะะพะดะณะพัะพะฒะบะฐ:

1. ะะฐัะตะณะธัััะธััะนัะตัั ะฝะฐ [Railway.app](https://railway.app)
2. ะฃััะฐะฝะพะฒะธัะต Railway CLI:
```bash
npm install -g @railway/cli
railway login
```

### ะะตะฟะปะพะน ะฑะฐะทั ะดะฐะฝะฝัั:

1. ะ Railway Dashboard: **New Project** โ **Provision PostgreSQL**
2. ะกะบะพะฟะธััะนัะต ะฟะตัะตะผะตะฝะฝัะต ะฟะพะดะบะปััะตะฝะธั (ะฒ Variables ะฒะบะปะฐะดะบะต)

### ะะตะฟะปะพะน ัะตัะฒะตัะฐ:

```bash
cd server
railway init
railway up

# ะะพะฑะฐะฒััะต ะฟะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั ะฒ Railway Dashboard:
# - DATABASE_URL (ะธะท PostgreSQL ัะตัะฒะธัะฐ)
# - NODE_ENV=production
```

### ะะตะฟะปะพะน ะบะปะธะตะฝัะฐ:

```bash
cd client
railway init

# ะฃะบะฐะถะธัะต build arguments:
railway run --build-arg VITE_API_URL=https://ะฒะฐั-server.railway.app

# ะะพะฑะฐะฒััะต ะฒ Variables:
# - VITE_API_URL=https://ะฒะฐั-server.railway.app
```

---

## โ๏ธ ะะตะฟะปะพะน ะฝะฐ Fly.io

[Fly.io](https://fly.io) - ะฟะปะฐััะพัะผะฐ ั ะณะปะพะฑะฐะปัะฝัะผ ัะฐัะฟัะตะดะตะปะตะฝะธะตะผ ะบะพะฝัะตะนะฝะตัะพะฒ.

### ะะพะดะณะพัะพะฒะบะฐ:

```bash
# ะฃััะฐะฝะพะฒะธัะต Fly CLI
curl -L https://fly.io/install.sh | sh

# ะะพะนะดะธัะต ะฒ ะฐะบะบะฐัะฝั
fly auth login
```

### ะะตะฟะปะพะน PostgreSQL:

```bash
# ะกะพะทะดะฐะนัะต PostgreSQL ะบะปะฐััะตั
fly postgres create --name cat-dogs-db

# ะกะพััะฐะฝะธัะต CONNECTION_STRING ะธะท ะฒัะฒะพะดะฐ ะบะพะผะฐะฝะดั
```

### ะะตะฟะปะพะน ัะตัะฒะตัะฐ:

```bash
cd server

# ะกะพะทะดะฐะนัะต ะฟัะธะปะพะถะตะฝะธะต
fly launch --name cat-dogs-api --region fra

# ะะพะฑะฐะฒััะต DATABASE_URL
fly secrets set DATABASE_URL="postgres://..." NODE_ENV=production

# ะะฐะดะตะฟะปะพะนัะต
fly deploy
```

### ะะตะฟะปะพะน ะบะปะธะตะฝัะฐ:

```bash
cd client

# ะกะพะทะดะฐะนัะต ะฟัะธะปะพะถะตะฝะธะต
fly launch --name cat-dogs-web --region fra

# ะฃััะฐะฝะพะฒะธัะต build arg
fly secrets set VITE_API_URL=https://cat-dogs-api.fly.dev

# ะะฐะดะตะฟะปะพะนัะต
fly deploy
```

---

## ๐ ะะพะปะตะทะฝัะต Docker ะบะพะผะฐะฝะดั

### ะะพะบะฐะปัะฝะฐั ัะฐะทัะฐะฑะพัะบะฐ:

```bash
# ะะตัะตัะพะฑัะฐัั ะพะดะธะฝ ัะตัะฒะธั
docker-compose build server

# ะะพัะผะพััะตัั ะปะพะณะธ
docker-compose logs -f server
docker-compose logs -f client

# ะะฐะฟัััะธัั ะบะพะผะฐะฝะดั ะฒ ะบะพะฝัะตะนะฝะตัะต
docker-compose exec server npm run migrate
docker-compose exec db psql -U postgres -d cat_dogs_db

# ะะตัะตะทะฐะฟัััะธัั ัะตัะฒะธั
docker-compose restart server
```

### ะัะธััะบะฐ:

```bash
# ะฃะดะฐะปะธัั ะฒัะต ะพััะฐะฝะพะฒะปะตะฝะฝัะต ะบะพะฝัะตะนะฝะตัั
docker container prune

# ะฃะดะฐะปะธัั ะฝะตะธัะฟะพะปัะทัะตะผัะต ะพะฑัะฐะทั
docker image prune -a

# ะฃะดะฐะปะธัั ะฝะตะธัะฟะพะปัะทัะตะผัะต volumes
docker volume prune

# ะะพะปะฝะฐั ะพัะธััะบะฐ
docker system prune -a --volumes
```

### ะัะปะฐะดะบะฐ:

```bash
# ะะพะนัะธ ะฒ ะบะพะฝัะตะนะฝะตั
docker-compose exec server sh
docker-compose exec client sh

# ะะพัะผะพััะตัั ะฟะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั
docker-compose exec server env

# ะัะพะฒะตัะธัั ัะพััะพัะฝะธะต ะะ
docker-compose exec db pg_isready -U postgres
```

---

## ๐ ะััะธัะตะบัััะฐ Docker Setup

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ           Docker Compose Stack              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                             โ
โ  โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ        โ
โ  โ   Client    โ    โ   Server    โ        โ
โ  โ  (Nginx)    โโโโโโ  (Node.js)  โ        โ
โ  โ  Port: 80   โ    โ  Port: 3001 โ        โ
โ  โโโโโโโโโโโโโโโ    โโโโโโโโฌโโโโโโโ        โ
โ                             โ               โ
โ                      โโโโโโโโผโโโโโโโ        โ
โ                      โ PostgreSQL  โ        โ
โ                      โ  Port: 5432 โ        โ
โ                      โโโโโโโโโโโโโโโ        โ
โ                                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## โ๏ธ ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั

### ะะปั ัะตัะฒะตัะฐ (server):
- `NODE_ENV` - ะพะบััะถะตะฝะธะต (production/development)
- `PORT` - ะฟะพัั ัะตัะฒะตัะฐ (ะฟะพ ัะผะพะปัะฐะฝะธั 3001)
- `DATABASE_URL` - ัััะพะบะฐ ะฟะพะดะบะปััะตะฝะธั ะบ PostgreSQL

### ะะปั ะบะปะธะตะฝัะฐ (client):
- `VITE_API_URL` - URL API ัะตัะฒะตัะฐ

### ะะปั ะฑะฐะทั ะดะฐะฝะฝัั (db):
- `POSTGRES_USER` - ะฟะพะปัะทะพะฒะฐัะตะปั ะะ
- `POSTGRES_PASSWORD` - ะฟะฐัะพะปั ะะ
- `POSTGRES_DB` - ะฝะฐะทะฒะฐะฝะธะต ะะ

---

## ๐ ะะตะทะพะฟะฐัะฝะพััั

### Production ัะตะบะปะธัั:

- โ ะัะฟะพะปัะทัะนัะต ัะธะปัะฝัะต ะฟะฐัะพะปะธ ะดะปั ะะ
- โ ะะต ะบะพะผะผะธัััะต `.env` ัะฐะนะปั ะฒ Git
- โ ะะบะปััะธัะต HTTPS ะฝะฐ production
- โ ะะฐัััะพะนัะต CORS ะฟัะฐะฒะธะปัะฝะพ
- โ ะัะฟะพะปัะทัะนัะต environment secrets ะฒ CI/CD
- โ ะะตะณัะปััะฝะพ ะพะฑะฝะพะฒะปัะนัะต Docker ะพะฑัะฐะทั

---

## ๐ ะัะธะผะตัะฐะฝะธั

1. **Docker Compose** ะฟัะตะดะฝะฐะทะฝะฐัะตะฝ ะดะปั **ะปะพะบะฐะปัะฝะพะน ัะฐะทัะฐะฑะพัะบะธ**
2. ะะปั **production** ะธัะฟะพะปัะทัะนัะต Railway, Fly.io ะธะปะธ ะดััะณะธะต ะฟะปะฐััะพัะผั
3. **Volumes** ัะพััะฐะฝััั ะดะฐะฝะฝัะต ะะ ะผะตะถะดั ะฟะตัะตะทะฐะฟััะบะฐะผะธ
4. ะัะธ ะธะทะผะตะฝะตะฝะธะธ ะบะพะดะฐ **ะฟะตัะตัะพะฑะธัะฐะนัะต** ะพะฑัะฐะทั: `docker-compose build`

---

## ๐ ะะตัะตะฝะธะต ะฟัะพะฑะปะตะผ

### ะะพัั ัะถะต ะทะฐะฝัั:

```bash
# ะะทะผะตะฝะธัะต ะฟะพััั ะฒ docker-compose.yml:
ports:
  - "8080:80"   # ะฒะผะตััะพ 80:80
  - "3002:3001" # ะฒะผะตััะพ 3001:3001
```

### ะะฐะทะฐ ะดะฐะฝะฝัั ะฝะต ะทะฐะฟััะบะฐะตััั:

```bash
# ะฃะดะฐะปะธัะต volume ะธ ะฟะตัะตัะพะทะดะฐะนัะต:
docker-compose down -v
docker-compose up --build
```

### ะะปะธะตะฝั ะฝะต ะฟะพะดะบะปััะฐะตััั ะบ ัะตัะฒะตัั:

ะัะพะฒะตัััะต `VITE_API_URL`:
- ะะพะบะฐะปัะฝะพ: `http://localhost:3001`
- Production: `https://your-api.example.com`

---

**ะะพัะพะฒะพ!** ะขะตะฟะตัั ั ะฒะฐั ะตััั ะฟะพะปะฝะฐั Docker ะบะพะฝัะธะณััะฐัะธั. ๐
